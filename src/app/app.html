<!-- Conditionally render based on authentication state -->
<div *ngIf="isLoggedIn; else loginComponent" class="chat-container">
  <!-- Chat Interface Header -->
  <div class="chat-header">
    <div class="container-fluid">
      <div class="row align-items-center">
        <div class="col">
          <h1 class="logo mb-0">Dangal Connect</h1>
        </div>
      </div>
    </div>
  </div>

  <!-- Connected User Info Section -->
  <div class="connected-user-section">
    <div class="container-fluid">
      <div class="connected-user-display">
        <div class="user-info-label">Connected to:</div>
        <div class="user-info-details">
          <div class="user-department">{{ connectedUser.department }}</div>
          <div class="user-program">{{ connectedUser.program }}</div>
          <div class="user-year">{{ connectedUser.year }}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Chat Messages Area -->
  <div class="chat-messages">
    <div class="container-fluid h-100">
      <div class="messages-container" #messagesContainer>
        <!-- System Welcome Messages -->
        <div class="message message-system">
          <div class="message-content">
            Welcome to Dangal Connect! ðŸ‘‹
          </div>
        </div>
        <div class="message message-system">
          <div class="message-content">
            You're now connected with a fellow Dangal ng Bayan from University of Cabuyao. Share your campus experiences, study tips, or just have a friendly chat! ðŸŽ“
          </div>
        </div>

        <!-- Dynamic User Messages -->
        <div class="message message-user" *ngFor="let message of messages">
          <div class="message-content">
            {{ message.text }}
          </div>
          <div class="message-time">
            {{ message.timestamp | date:'shortTime' }}
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Message Input Area -->
  <div class="chat-input">
    <div class="container-fluid">
      <div class="input-container">
        <div class="row g-2 align-items-end">
          <div class="col">
            <textarea
              class="form-control message-input"
              rows="1"
              placeholder="Type your message..."
              [(ngModel)]="newMessage"
              (keydown.enter)="sendMessage(); $event.preventDefault()"
              #messageTextarea></textarea>
          </div>
          <div class="col-auto">
            <button
              class="btn btn-dark send-btn"
              [disabled]="!newMessage.trim()"
              (click)="sendMessage()">
              Send
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Login Component -->
<ng-template #loginComponent>
  <app-login></app-login>
</ng-template>
